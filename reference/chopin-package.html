<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computation of spatial data by hierarchical and objective partitioning of inputs for parallel processing — chopin-package • chopin</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computation of spatial data by hierarchical and objective partitioning of inputs for parallel processing — chopin-package"><meta name="description" content="The chopin package provides a set of functions to compute on divided
geospatial data."><meta property="og:description" content="The chopin package provides a set of functions to compute on divided
geospatial data."><meta property="og:image" content="https://docs.ropensci.org/chopin/logo.svg"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">chopin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01_start.html">Getting started with chopin</a></li>
    <li><a class="dropdown-item" href="../articles/v02_good_practice.html">Good practice of using `chopin`</a></li>
    <li><a class="dropdown-item" href="../articles/v03_par_pad_grid.html">Generate computational grids</a></li>
    <li><a class="dropdown-item" href="../articles/v04_climate_examples.html">Extracting Weather/Climate Geospatial Data with `chopin`</a></li>
    <li><a class="dropdown-item" href="../articles/v05_targets.html">targets and grid objects</a></li>
  </ul></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/chopin/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Computation of spatial data by hierarchical and objective partitioning of inputs for parallel processing</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/chopin/blob/master/R/chopin-package.R" class="external-link"><code>R/chopin-package.R</code></a></small>
      <div class="d-none name"><code>chopin-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>chopin</code> package provides a set of functions to compute on divided
geospatial data.</p>
    </div>


    <div class="section level2">
    <h2 id="basic-functionalities">Basic functionalities<a class="anchor" aria-label="anchor" href="#basic-functionalities"></a></h2>


<ul><li><p>Distribute <code>terra</code>, <code>sf</code>, and <code>chopin</code> functions to parallel workers set by <code>future</code> or <code>mirai</code></p></li>
<li><p>Set parallelization strategies based on artificial grids, equal-size clusters, hierarchy, and multiple raster files</p></li>
<li><p>Convenience functions for raster-vector overlay and weighted summary from vector dataset</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="chopin-workflow"><code>chopin</code> workflow<a class="anchor" aria-label="anchor" href="#chopin-workflow"></a></h2>


<ul><li><p>The simplest way of parallelizing generic geospatial computation is to start from <code>par_pad_*</code> functions to <code>par_grid</code>, or running <code>par_hierarchy</code>, or <code>par_multirasters</code> functions at once.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/chopin">chopin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sebkrantz.github.io/collapse/" class="external-link">collapse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.mirai.futureverse.org" class="external-link">future.mirai</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></span><span class="op">)</span></span></code></pre><p></p></div>
<p><strong>Example data</strong></p><ul><li><p>North Carolinian counties and a raster of elevation data are used as example data.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">nccnty_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"nc_hierarchy.gpkg"</span>, package <span class="op">=</span> <span class="st">"chopin"</span><span class="op">)</span></span>
<span><span class="va">ncelev_path</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/nc_srtm15_otm.tif"</span>, package <span class="op">=</span> <span class="st">"chopin"</span><span class="op">)</span></span>
<span><span class="va">nccnty</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">nccnty_path</span><span class="op">)</span></span>
<span><span class="va">ncelev</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ncelev_path</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>To demonstrate chopin functions, we generate 10,000 random points in North Carolina</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">ncsamp</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/sample.html" class="external-link">spatSample</a></span><span class="op">(</span></span>
<span>    <span class="va">nccnty</span>,</span>
<span>    <span class="fl">1e4L</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">ncsamp</span><span class="op">$</span><span class="va">pid</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ncsamp</span><span class="op">)</span></span></code></pre><p></p></div>
<p><strong>Creating grids</strong></p><ul><li><p>The example below will generate a regular grid from the random point data.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">ncgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/par_pad_grid.html">par_pad_grid</a></span><span class="op">(</span><span class="va">ncsamp</span>, mode <span class="op">=</span> <span class="st">"grid"</span>, nx <span class="op">=</span> <span class="fl">4L</span>, ny <span class="op">=</span> <span class="fl">2L</span>, padding <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ncgrid</span><span class="op">$</span><span class="va">original</span><span class="op">)</span></span></code></pre><p></p></div>
<p><strong>Extracting values from raster</strong></p><ul><li><p>Since all <code>par_*</code> functions operate on <code>future</code> backends, users should define the future plan before running the functions. <code>multicore</code> plan supports <code>terra</code> objects which may lead to faster computation, but it is not supported in Windows. An alternative is <code>future.mirai</code>'s <code>mirai_multisession</code> plan, which is supported in many platforms and generally faster than plain future multisession plan.</p></li>
<li><p><code>workers</code> argument should be defined with an integer value to specify the number of threads to be used.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future.mirai</span><span class="fu">::</span><span class="va"><a href="https://future.mirai.futureverse.org/reference/mirai_multisession.html" class="external-link">mirai_multisession</a></span>, workers <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>Then we dispatch multiple <code>extract_at</code> runs on the grid polygons.</p></li>
<li><p>Before we proceed, the terra object should be converted to sf object.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">pg</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/par_grid.html">par_grid</a></span><span class="op">(</span></span>
<span>    grids <span class="op">=</span> <span class="va">ncgrid</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .debug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    fun_dist <span class="op">=</span> <span class="va">extract_at</span>,</span>
<span>    x <span class="op">=</span> <span class="va">ncelev_path</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">ncsamp</span><span class="op">)</span>,</span>
<span>    id <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>    func <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p><strong>Hierarchical processing</strong></p><ul><li><p>Here we demonstrate hierarchical processing of the random points using census tract polygons.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">nccnty</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">nccnty_path</span>, layer <span class="op">=</span> <span class="st">"county"</span><span class="op">)</span></span>
<span><span class="va">nctrct</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">nccnty_path</span>, layer <span class="op">=</span> <span class="st">"tracts"</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>The example below will parallelize summarizing mean elevation at 10 kilometers circular buffers of random sample points by the first five characters of census tract unique identifiers, which are county codes.</p></li>
<li><p>This example demonstrates the hierarchy can be defined from any given polygons if the unique identifiers are suitably formatted for defining the hierarchy.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">px</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/par_hierarchy.html">par_hierarchy</a></span><span class="op">(</span></span>
<span>    <span class="co"># from here the par_hierarchy-specific arguments</span></span>
<span>    regions <span class="op">=</span> <span class="va">nctrct</span>,</span>
<span>    regions_id <span class="op">=</span> <span class="st">"GEOID"</span>,</span>
<span>    length_left <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    pad <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .debug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># from here are the dispatched function definition</span></span>
<span>    <span class="co"># for parallel workers</span></span>
<span>    fun_dist <span class="op">=</span> <span class="va">extract_at</span>,</span>
<span>    <span class="co"># below should follow the arguments of the dispatched function</span></span>
<span>    x <span class="op">=</span> <span class="va">ncelev</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">ncsamp</span><span class="op">)</span>,</span>
<span>    id <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>    func <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p><strong>Multiraster processing</strong></p><ul><li><p>Here we demonstrate multiraster processing of the random points using multiple rasters.</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">ncelev</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/nc_srtm15_otm.tif"</span>, package <span class="op">=</span> <span class="st">"chopin"</span><span class="op">)</span></span>
<span><span class="va">ncelev</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ncelev</span><span class="op">)</span></span>
<span><span class="va">tdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span>check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ncelev</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tdir</span>, <span class="st">"test1.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ncelev</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tdir</span>, <span class="st">"test2.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ncelev</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tdir</span>, <span class="st">"test3.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ncelev</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tdir</span>, <span class="st">"test4.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ncelev</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tdir</span>, <span class="st">"test5.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">tdir</span>, pattern <span class="op">=</span> <span class="st">"tif$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/par_multirasters.html">par_multirasters</a></span><span class="op">(</span></span>
<span>    filenames <span class="op">=</span> <span class="va">rasts</span>,</span>
<span>    fun_dist <span class="op">=</span> <span class="va">extract_at</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">ncsamp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span>,</span>
<span>    id <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>    func <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    .debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="function-selection-guide-for-par-">Function selection guide for <code>par_*()</code><a class="anchor" aria-label="anchor" href="#function-selection-guide-for-par-"></a></h2>


<p>We provide two flowcharts to help users choose the right function for
parallel processing. The raster-oriented flowchart is for users who
want to start with raster data, and the vector-oriented flowchart
is for users with large vector data.</p>
<p>In <strong>raster-oriented selection</strong>, we suggest four factors to consider:</p><ul><li><p>Number of raster files: for multiple files, <code>par_multirasters</code> is recommended. When there are multiple rasters that share the same extent and resolution, consider stacking the rasters into multilayer SpatRaster object by calling <code>terra::rast(filenames)</code>.</p></li>
<li><p>Raster resolution: We suggest 100 meters as a threshold. Rasters with resolution coarser than 100 meters and a few layers would be better for the direct call of <code><a href="https://isciences.gitlab.io/exactextractr/reference/exact_extract.html" class="external-link">exactextractr::exact_extract()</a></code>.</p></li>
<li><p>Raster extent: Using <code>SpatRaster</code> in <code><a href="https://isciences.gitlab.io/exactextractr/reference/exact_extract.html" class="external-link">exactextractr::exact_extract()</a></code> is often minimally affected by the raster extent.</p></li>
<li><p>Memory size: <code>max_cells_in_memory</code> argument value of <code><a href="https://isciences.gitlab.io/exactextractr/reference/exact_extract.html" class="external-link">exactextractr::exact_extract()</a></code>, raster resolution, and the number of layers in <code>SpatRaster</code> are multiplicatively related to the memory usage.</p></li>
</ul><p>For <strong>vector-oriented selection</strong>, we suggest three factors to consider:</p><ul><li><p>Number of features: When the number of features is over 100,000, consider using <code>par_grid</code> or <code>par_hierarchy</code> to split the data into smaller chunks.</p></li>
<li><p>Hierarchical structure: If the data has a hierarchical structure, consider using <code>par_hierarchy</code> to parallelize the operation.</p></li>
<li><p>Data grouping: If the data needs to be grouped in similar sizes, consider using <code>par_pad_balanced</code> or <code>par_pad_grid</code> with <code>mode = "grid_quantile"</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="caveats">Caveats<a class="anchor" aria-label="anchor" href="#caveats"></a></h2>


<p><strong>Why parallelization is slower than the ordinary function run?</strong>
Parallelization may underperform when the datasets are too small
to take advantage of divide-and-compute approach, where
parallelization overhead is involved. Overhead here refers to
the required amount of computational resources for transferring
objects to multiple processes. Since the demonstrations above
use quite small datasets, the advantage of parallelization was not
as noticeable as it was expected. Should a large amount of
data (spatial/temporal resolution or number of files,
for example) be processed, users could find the efficiency of this
package. A vignette in this package demonstrates use cases
extracting various climate/weather datasets.</p>
<p><strong>Notes on data restrictions</strong></p>
<p><code>chopin</code> works best with <strong>two-dimensional</strong> (<strong>planar</strong>) geometries.
Users should disable <code>s2</code> spherical geometry mode in <code>sf</code> by setting
<code>sf::sf_use_s2(FALSE)</code>.
Running any <code>chopin</code> functions at spherical or three-dimensional
(e.g., including M/Z dimensions) geometries
may produce incorrect or unexpected results.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://docs.ropensci.org/chopin">https://docs.ropensci.org/chopin</a></p></li>
<li><p><a href="https://github.com/ropensci/chopin" class="external-link">https://github.com/ropensci/chopin</a></p></li>
<li><p>Report bugs at <a href="https://github.com/ropensci/chopin/issues" class="external-link">https://github.com/ropensci/chopin/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Insang Song <a href="mailto:geoissong@gmail.com">geoissong@gmail.com</a> (<a href="https://orcid.org/0000-0001-8732-3256" class="external-link">ORCID</a>)</p>
<p>Authors:</p><ul><li><p>Kyle Messier (<a href="https://orcid.org/0000-0001-9508-9623" class="external-link">ORCID</a>) [contributor]</p></li>
</ul><p>Other contributors:</p><ul><li><p>Alec L. Robitaille (Alec reviewed the package version 0.6.3 for rOpenSci, see &lt;https://github.com/ropensci/software-review/issues/638&gt;) [reviewer]</p></li>
<li><p>Eric R. Scott (Eric reviewed the package version 0.6.3 for rOpenSci, see &lt;https://github.com/ropensci/software-review/issues/638&gt;) [reviewer]</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

